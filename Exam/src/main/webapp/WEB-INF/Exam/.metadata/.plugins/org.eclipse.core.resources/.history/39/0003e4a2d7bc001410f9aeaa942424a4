<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>시험의 정석</title>
<%@include file="/resources/inc/Extend.jsp" %>
<link rel="stylesheet" type="text/css" href="/exam/resources/dist/css/qna.css" />
<script type="text/javascript">

	$(document).ready(function(){
		var Json = ${JsonList};
		//console.log(Json);
		
		if ( Json ) {
			for ( var i = 0; i < Json.length; i++ ) {
				
				var tag = "";
				tag += "<tr class='line"+ Json[i].seq +"' onclick='QNAView(" + Json[i].seq +")'>";
				tag += "<td class='QNA_seq'>" + Json[i].seq + "</td>";
				tag += "<td class='QNA_subject'>";
				
				if( Json[i].answer ) {
					tag += "<img src='/exam/resources/images/icons/re_icon.png' />";
				} else {
					tag += "<img src='/exam/resources/images/icons/re_ready.png' />";
				}
				tag += Json[i].subject + "</td>";
				tag += "<td class='QNA_writer'>" + Json[i].writer + "</td>";
				tag += "<td class='QNA_regDate'>" + Json[i].regDate + "</td>";
				tag += "</tr>";
				
				//console.log(tag);
				
				$("#QNA").append(tag);
			}
		}
		
	});

	var flag = false;
	
	function QNAView(seq) {
		
		
		var seq = seq;
		//alert(seq);
		
		if ( !flag ) {
			$.ajax({
				type: "GET",
				url: "/exam/community/qnaview.action",
				data: "seq=" + seq,
				success: function(view){
					//console.log(view);
				
					var obj = $.parseJSON(view);
					//console.log(obj.content);
					
					if(obj.answer == 'null' || obj.answer == null) {
						obj.answer = "아직 답변이 등록되지 않았습니다.<br />" +
									"빠른 시간 내에 답변할 수 있도록 노력하겠습니다.";
					}
					
					var tag = "";
					tag += "<tr class='view'>";
					tag += "<td id='view_Q'>Q.</td>";
					tag += "<td colspan='3'>" + obj.content + "</td>";
					tag += "</tr>";
					tag += "<tr class='view'>";
					tag += "<td id='view_A'>A.</td>";
					tag += "<td colspan='3'>" + obj.answer + "</td>";
					tag += "</tr>";
					$(".line" + seq).css("backgroundColor","#6897f7");
					$(".line" + seq + " td").css("color","#FFFFFF");
					$(".line" + seq).after(tag);
					
					flag = true;
					
				}
			});
			
		} else if ( flag ) {
			
			$(".view").remove();
			$(".line" + seq).css("backgroundColor","inherit");
			$(".line" + seq + " td").css("color","inherit");
			flag = false;
		}

	}

</script>
</head>
<body>

<!-- Header 시작 -->
<div id="header"><%@include file="/resources/inc/Menu.jsp" %></div>
<!-- Header 끝 -->


<!-- Container 시작 -->
<div id="container">

	<!-- 1. 현재 작업 위치 -->
	<div id="locationBar">
		
		<div id="locationBar_child">
			<a href="/exam/home.action"><img src="/exam/resources/images/icons/1424745333_home.png" /> 홈</a> &gt; 
			
			<a href="#">커뮤니티</a> &gt;  <!-- 상단메뉴(카테고리) 제목과 해당 링크 수정 -->
			
			<a href="/exam/community/qna.action">질문과 답변, QnA</a>  <!-- 해당페이지 제목(서브메뉴 제목) 과 해당 링크 수정 -->
		</div>	
		
	</div>
	
	
	<!-- 본문블럭 시작--> 
	<div id="mainBlock">
		
		<!-- 2. 사이드바 -->
		<div id="aside">
		
			<div id="side_title">커뮤니티</div><!-- 제작 페이지의 카테고리 제목 -->
		
			<div id="side_menu">
				<ul>
				
				<!-- 
					 아래 리스트는 사이드바의 메뉴 리스트 해당 링크 걸고, 메뉴 제목고치고, 
					 필요없는 리스트는 지우면 됩니다. 
					
					 ** 현재페이지에 해당하는 <li>태그에 side_select 클래스를 적용하세요!	
				-->
					
					<li class="side_select" onclick="location.href='/exam/community/qna.action'">질문과 답변, QnA</li>
					<li onclick="location.href='#'">서브메뉴2</li>
					<li onclick="location.href='#'">서브메뉴3</li>
					<li onclick="location.href='#'">서브메뉴4</li>
					<li onclick="location.href='#'">서브메뉴5</li>
					<li onclick="location.href='#'">서브메뉴6</li>
					<li onclick="location.href='#'">서브메뉴7</li>
					<li onclick="location.href='#'">서브메뉴8</li>
					<li onclick="location.href='#'">서브메뉴9</li>
					<li onclick="location.href='#'">서브메뉴10</li>
				</ul>
			</div>
		</div>
		<script type="text/javascript" src="/exam/resources/dist/js/sidebar.js"></script>
		
		
		<!-- 3. 본문 -->
		<div id="content">
			
			<div id="content_title">질문과 답변, QnA</div><!-- 본문 상단의 타이틀(해당페이지 제목) -->
			
			<div id="content_body">
			<!-- #content_body 박스 : 이하 본문 작성하시면됩니다.  -->	
				
				
				<table id="QNA" class="table tbl2">
					<tr>
						<th>번호</th>
						<th>질문/답변</th>
						<th>작성자</th>
						<th>작성일</th>
					</tr>
				</table>
				
				
			</div>
		</div>
	
	</div><!-- 본문블럭 끝-->
	
</div>
<!-- Container 끝 -->


<!-- Footer 시작 -->
<div id="footer"><%@include file="/resources/inc/Copyright.jsp" %></div>
<!-- Footer 끝 -->
</body>
</html>